<?xml version="1.0"?>
<launch>
  <!-- Launch Arguments -->
  <arg name="use_sim" default="true" description="Start robot in Gazebo simulation."/>
  <arg name="world_file" default="empty.sdf" description="Gazebo world file to load."/>

  <!-- Robot Description -->
  <param name="robot_description" value="$(find-pkg-share description)/docky/urdf/docky.urdf"/>

  <!-- Robot State Publisher -->
  <node pkg="robot_state_publisher" exec="robot_state_publisher" name="robot_state_publisher" output="both">
    <param name="use_sim_time" value="true"/>
  </node>

  <!-- Start Gazebo Sim with ROS 2 bridge plugins -->
  <group if="$(var use_sim)">
    <executable cmd="gz sim -s libgazebo_ros_factory.so -s libgazebo_ros_state.so $(var world_file)" output="screen"/>
  </group>

  <!-- Spawn the robot using the ROS 2 spawn service -->
  <group if="$(var use_sim)">
    <node pkg="gazebo_ros" exec="spawn_entity.py" name="spawn_entity" output="screen"
          args="-topic robot_description -entity docky"/>
  </group>

</launch> 